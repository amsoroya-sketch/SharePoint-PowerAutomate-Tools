<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PnP PowerShell - Power Platform Documentation</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Power Platform Setup Documentation</h1>
            <p class="subtitle">SharePoint Permission Scanner Project</p>
        </header>

        <div class="main-content">
            <nav class="sidebar">
                <div class="nav-section">
<h3>Getting Started</h3>
<ul>
<li><a href="README.html">Overview</a></li>
<li><a href="CLI-TOOLS-SETUP.html">CLI Tools Setup</a></li>
</ul>
</div>
<div class="nav-section">
<h3>CLI Tools</h3>
<ul>
<li><a href="cli-tools-install-all-ps1.html">Installation Script</a></li>
<li><a href="cli-tools-pac-cli.html">PAC CLI</a></li>
<li><a href="cli-tools-m365-cli.html">m365 CLI</a></li>
<li><a href="cli-tools-az-cli.html">Azure CLI</a></li>
<li><a href="cli-tools-func-cli.html">Functions CLI</a></li>
<li><a href="cli-tools-pnp-powershell.html" class="active">PnP PowerShell</a></li>
</ul>
</div>
<div class="nav-section">
<h3>Power Platform</h3>
<ul>
<li><a href="01-power-automate-setup-guide.html">Power Automate</a></li>
<li><a href="01-power-automate-troubleshooting.html">Troubleshooting</a></li>
<li><a href="01-power-automate-cli-reference.html">CLI Reference</a></li>
<li><a href="02-power-apps-setup-guide.html">Power Apps</a></li>
<li><a href="03-dataverse-setup-guide.html">Dataverse</a></li>
<li><a href="03-dataverse-cli-reference.html">Dataverse CLI</a></li>
</ul>
</div>
<div class="nav-section">
<h3>Microsoft 365</h3>
<ul>
<li><a href="04-sharepoint-setup-guide.html">SharePoint</a></li>
<li><a href="04-sharepoint-cli-reference.html">SharePoint CLI</a></li>
<li><a href="08-teams-setup-guide.html">Microsoft Teams</a></li>
<li><a href="11-microsoft-graph-setup-guide.html">Microsoft Graph</a></li>
</ul>
</div>
<div class="nav-section">
<h3>Azure</h3>
<ul>
<li><a href="05-azure-portal-app-registration.html">App Registration</a></li>
<li><a href="09-azure-functions-setup-guide.html">Azure Functions</a></li>
<li><a href="10-azure-keyvault-setup-guide.html">Key Vault</a></li>
<li><a href="07-azure-devops-setup-guide.html">Azure DevOps</a></li>
<li><a href="06-power-bi-setup-guide.html">Power BI</a></li>
</ul>
</div>
<div class="nav-section">
<h3>MCP Servers</h3>
<ul>
<li><a href="mcp-servers-README.html">Overview</a></li>
<li><a href="mcp-servers-sharepoint-mcp.html">SharePoint MCP</a></li>
<li><a href="mcp-servers-azure-devops-mcp.html">DevOps MCP</a></li>
<li><a href="mcp-servers-dataverse-mcp.html">Dataverse MCP</a></li>
</ul>
</div>
<div class="nav-section">
<h3>Skills</h3>
<ul>
<li><a href="skills-README.html">Skills Overview</a></li>
<li><a href="skills-skill-usage-guide.html">Usage Guide</a></li>
<li><a href="skills-knowledge-base-index.html">Knowledge Base</a></li>
</ul>
</div>

            </nav>

            <main class="content">
                <div class="source-info">
                    <span>Source: cli-tools/pnp-powershell.md</span>
                    <span>Generated: 2026-01-09 19:55</span>
                </div>
                <h1>PnP PowerShell</h1>
<p>
PowerShell module for SharePoint Online administration and management.
</p>
<hr>
<h2>Installation</h2>
<h3>Install Module</h3>
<pre><code class="language-powershell"># Current user (no admin required)
Install-Module -Name PnP.PowerShell -Scope CurrentUser
</p>
<h1>All users (requires admin)</h1>
Install-Module -Name PnP.PowerShell -Scope AllUsers
</code></pre>
<h3>Update Module</h3>
<pre><code class="language-powershell">Update-Module -Name PnP.PowerShell
</code></pre>
<h3>Verify Installation</h3>
<pre><code class="language-powershell">Get-Module -Name PnP.PowerShell -ListAvailable
</code></pre>
<hr>
<h2>Authentication</h2>
<h3>Interactive Login</h3>
<pre><code class="language-powershell"># Opens browser for authentication
Connect-PnPOnline -Url "https://tenant.sharepoint.com/sites/sitename" -Interactive
</code></pre>
<h3>Device Login</h3>
<pre><code class="language-powershell">Connect-PnPOnline -Url "https://tenant.sharepoint.com/sites/sitename" -DeviceLogin
</code></pre>
<h3>With Credentials</h3>
<pre><code class="language-powershell">$creds = Get-Credential
Connect-PnPOnline -Url "https://tenant.sharepoint.com/sites/sitename" -Credentials $creds
</code></pre>
<h3>App-Only (Certificate)</h3>
<pre><code class="language-powershell">Connect-PnPOnline -Url "https://tenant.sharepoint.com/sites/sitename" <code>
    -ClientId "APP_ID" </code>
    -Tenant "tenant.onmicrosoft.com" <code>
    -CertificatePath ".\certificate.pfx" </code>
    -CertificatePassword (ConvertTo-SecureString "password" -AsPlainText -Force)
</code></pre>
<h3>Check Connection</h3>
<pre><code class="language-powershell">Get-PnPConnection
</code></pre>
<h3>Disconnect</h3>
<pre><code class="language-powershell">Disconnect-PnPOnline
</code></pre>
<hr>
<h2>Site Operations</h2>
<h3>Get Site Info</h3>
<pre><code class="language-powershell">Get-PnPSite
Get-PnPWeb
</code></pre>
<h3>Create Subsite</h3>
<pre><code class="language-powershell">New-PnPWeb -Title "Subsite" -Url "subsite" -Template "STS#3"
</code></pre>
<h3>Get Site Properties</h3>
<pre><code class="language-powershell">Get-PnPSite -Includes StorageUsageCurrent, StorageQuota
</code></pre>
<hr>
<h2>List/Library Operations</h2>
<h3>Get Lists</h3>
<pre><code class="language-powershell">Get-PnPList
</code></pre>
<h3>Get Specific List</h3>
<pre><code class="language-powershell">Get-PnPList -Identity "Documents"
</code></pre>
<h3>Create Document Library</h3>
<pre><code class="language-powershell">New-PnPList -Title "MyLibrary" -Template DocumentLibrary
</code></pre>
<h3>Create List</h3>
<pre><code class="language-powershell">New-PnPList -Title "MyList" -Template GenericList
</code></pre>
<hr>
<h2>Folder Operations</h2>
<h3>Get Folders</h3>
<pre><code class="language-powershell">Get-PnPFolderItem -FolderSiteRelativeUrl "Shared Documents"
</code></pre>
<h3>Create Folder</h3>
<pre><code class="language-powershell">Add-PnPFolder -Name "NewFolder" -Folder "Shared Documents"
</code></pre>
<h3>Get Folder Recursively</h3>
<pre><code class="language-powershell">Get-PnPFolderItem -FolderSiteRelativeUrl "Shared Documents" -Recursive
</code></pre>
<h3>Delete Folder</h3>
<pre><code class="language-powershell">Remove-PnPFolder -Name "FolderName" -Folder "Shared Documents" -Force
</code></pre>
<hr>
<h2>File Operations</h2>
<h3>Upload File</h3>
<pre><code class="language-powershell">Add-PnPFile -Path "C:\local\file.docx" -Folder "Shared Documents"
</code></pre>
<h3>Download File</h3>
<pre><code class="language-powershell">Get-PnPFile -Url "/sites/sitename/Shared Documents/file.docx" -Path "C:\local" -FileName "file.docx" -AsFile
</code></pre>
<h3>Delete File</h3>
<pre><code class="language-powershell">Remove-PnPFile -ServerRelativeUrl "/sites/sitename/Shared Documents/file.docx" -Force
</code></pre>
<hr>
<h2>Permission Operations</h2>
<h3>Get Permissions</h3>
<pre><code class="language-powershell"># Site permissions
Get-PnPSiteGroup
</p>
<h1>List permissions</h1>
Get-PnPListPermissions -Identity "Documents"
</p>
<h1>Item permissions</h1>
Get-PnPListItemPermission -List "Documents" -Identity 1
</code></pre>
<h3>Check Unique Permissions</h3>
<pre><code class="language-powershell">$folder = Get-PnPFolder -Url "Shared Documents/MyFolder"
$folder.ListItemAllFields.HasUniqueRoleAssignments
</code></pre>
<h3>Break Inheritance</h3>
<pre><code class="language-powershell">Set-PnPListItemPermission -List "Documents" -Identity 1 -InheritPermissions:$false
</code></pre>
<h3>Grant Permission</h3>
<pre><code class="language-powershell">Set-PnPListItemPermission -List "Documents" -Identity 1 -User "user@tenant.com" -AddRole "Edit"
</code></pre>
<h3>Remove Permission</h3>
<pre><code class="language-powershell">Set-PnPListItemPermission -List "Documents" -Identity 1 -User "user@tenant.com" -RemoveRole "Edit"
</code></pre>
<h3>Reset Inheritance</h3>
<pre><code class="language-powershell">Set-PnPListItemPermission -List "Documents" -Identity 1 -InheritPermissions:$true
</code></pre>
<hr>
<h2>User/Group Operations</h2>
<h3>Get Site Users</h3>
<pre><code class="language-powershell">Get-PnPUser
</code></pre>
<h3>Get Site Groups</h3>
<pre><code class="language-powershell">Get-PnPSiteGroup
</code></pre>
<h3>Add User to Group</h3>
<pre><code class="language-powershell">Add-PnPUserToGroup -LoginName "user@tenant.com" -Identity "Site Members"
</code></pre>
<hr>
<h2>Batch Operations</h2>
<h3>Batch Context</h3>
<pre><code class="language-powershell">$batch = New-PnPBatch
</p>
<h1>Add items to batch</h1>
Add-PnPListItem -List "MyList" -Values @{"Title" = "Item 1"} -Batch $batch
Add-PnPListItem -List "MyList" -Values @{"Title" = "Item 2"} -Batch $batch
Add-PnPListItem -List "MyList" -Values @{"Title" = "Item 3"} -Batch $batch
</p>
<h1>Execute batch</h1>
Invoke-PnPBatch -Batch $batch
</code></pre>
<hr>
<h2>Project-Specific Commands</h2>
<h3>Connect to Test Site</h3>
<pre><code class="language-powershell">Connect-PnPOnline -Url "https://abctest179.sharepoint.com/sites/Permission-Scanner-Test" -Interactive
</code></pre>
<h3>List Test Library Folders</h3>
<pre><code class="language-powershell">Get-PnPFolderItem -FolderSiteRelativeUrl "TestLibrary_Basic" -Recursive |
    Select-Object Name, ServerRelativeUrl, ItemCount
</code></pre>
<h3>Check Folder Permissions</h3>
<pre><code class="language-powershell">$folders = Get-PnPFolderItem -FolderSiteRelativeUrl "TestLibrary_Basic" -Recursive -ItemType Folder
</p>
<p>
foreach ($folder in $folders) {
    $item = Get-PnPProperty -ClientObject $folder -Property ListItemAllFields
    $hasUnique = Get-PnPProperty -ClientObject $item -Property HasUniqueRoleAssignments
</p>
<p>
    Write-Host "$($folder.Name): HasUniquePermissions = $hasUnique"
}
</code></pre>
<hr>
<h2>Troubleshooting</h2>
<table>
<thead><tr><th>Error</th><th>Solution</th></tr></thead>
<tbody><tr><td>"Access denied"</td><td>Check user permissions</td></tr>
<tr><td>"Site not found"</td><td>Verify URL is correct</td></tr>
<tr><td>"Not connected"</td><td>Run <code>Connect-PnPOnline</code></td></tr>
<tr><td>"Module not found"</td><td>Run <code>Install-Module PnP.PowerShell</code></td></tr>
</tbody></table>
<h3>Check Current Context</h3>
<pre><code class="language-powershell">Get-PnPContext
Get-PnPConnection
</code></pre>
<h3>Verbose Output</h3>
<pre><code class="language-powershell">Get-PnPList -Verbose
</code></pre>
<hr>
<h2>Related Documentation</h2>
<ul><li><a href="https://pnp.github.io/powershell/" target="_blank">PnP PowerShell Documentation</a></li>
<li><a href="https://pnp.github.io/powershell/cmdlets/" target="_blank">PnP PowerShell Cmdlets</a></li>
</ul>
<hr>
<p>
<em>Last Updated: 2026-01-08</em>

</p>
            </main>
        </div>

        <footer>
            <p>Generated from Markdown documentation | Power Platform Setup Guide</p>
        </footer>
    </div>
</body>
</html>