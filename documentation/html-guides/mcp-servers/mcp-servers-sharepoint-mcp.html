<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SharePoint MCP - Power Platform Documentation</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Power Platform Setup Documentation</h1>
            <p class="subtitle">SharePoint Permission Scanner Project</p>
        </header>

        <div class="main-content">
            <nav class="sidebar">
                <div class="nav-section">
<h3>Getting Started</h3>
<ul>
<li><a href="README.html">Overview</a></li>
<li><a href="CLI-TOOLS-SETUP.html">CLI Tools Setup</a></li>
</ul>
</div>
<div class="nav-section">
<h3>CLI Tools</h3>
<ul>
<li><a href="cli-tools-install-all-ps1.html">Installation Script</a></li>
<li><a href="cli-tools-pac-cli.html">PAC CLI</a></li>
<li><a href="cli-tools-m365-cli.html">m365 CLI</a></li>
<li><a href="cli-tools-az-cli.html">Azure CLI</a></li>
<li><a href="cli-tools-func-cli.html">Functions CLI</a></li>
<li><a href="cli-tools-pnp-powershell.html">PnP PowerShell</a></li>
</ul>
</div>
<div class="nav-section">
<h3>Power Platform</h3>
<ul>
<li><a href="01-power-automate-setup-guide.html">Power Automate</a></li>
<li><a href="01-power-automate-troubleshooting.html">Troubleshooting</a></li>
<li><a href="01-power-automate-cli-reference.html">CLI Reference</a></li>
<li><a href="02-power-apps-setup-guide.html">Power Apps</a></li>
<li><a href="03-dataverse-setup-guide.html">Dataverse</a></li>
<li><a href="03-dataverse-cli-reference.html">Dataverse CLI</a></li>
</ul>
</div>
<div class="nav-section">
<h3>Microsoft 365</h3>
<ul>
<li><a href="04-sharepoint-setup-guide.html">SharePoint</a></li>
<li><a href="04-sharepoint-cli-reference.html">SharePoint CLI</a></li>
<li><a href="08-teams-setup-guide.html">Microsoft Teams</a></li>
<li><a href="11-microsoft-graph-setup-guide.html">Microsoft Graph</a></li>
</ul>
</div>
<div class="nav-section">
<h3>Azure</h3>
<ul>
<li><a href="05-azure-portal-app-registration.html">App Registration</a></li>
<li><a href="09-azure-functions-setup-guide.html">Azure Functions</a></li>
<li><a href="10-azure-keyvault-setup-guide.html">Key Vault</a></li>
<li><a href="07-azure-devops-setup-guide.html">Azure DevOps</a></li>
<li><a href="06-power-bi-setup-guide.html">Power BI</a></li>
</ul>
</div>
<div class="nav-section">
<h3>MCP Servers</h3>
<ul>
<li><a href="mcp-servers-README.html">Overview</a></li>
<li><a href="mcp-servers-sharepoint-mcp.html" class="active">SharePoint MCP</a></li>
<li><a href="mcp-servers-azure-devops-mcp.html">DevOps MCP</a></li>
<li><a href="mcp-servers-dataverse-mcp.html">Dataverse MCP</a></li>
</ul>
</div>
<div class="nav-section">
<h3>Skills</h3>
<ul>
<li><a href="skills-README.html">Skills Overview</a></li>
<li><a href="skills-skill-usage-guide.html">Usage Guide</a></li>
<li><a href="skills-knowledge-base-index.html">Knowledge Base</a></li>
</ul>
</div>

            </nav>

            <main class="content">
                <div class="source-info">
                    <span>Source: mcp-servers/sharepoint-mcp.md</span>
                    <span>Generated: 2026-01-09 19:55</span>
                </div>
                <h1>SharePoint MCP Server</h1>
<p>
Real-time SharePoint access for Claude via Model Context Protocol.
</p>
<hr>
<h2>Overview</h2>
<p>
<strong>Package:</strong> <code>@alliottech/sharepoint-mcp-server</code>
<strong>Repository:</strong> https://github.com/alliottech/sharepoint-mcp-server
</p>
<hr>
<h2>Configuration</h2>
<h3>.mcp.json Entry</h3>
<pre><code class="language-json">{
  "sharepoint": {
    "command": "npx",
    "args": ["-y", "@alliottech/sharepoint-mcp-server"],
    "env": {
      "SHAREPOINT_URL": "${SHAREPOINT_URL}",
      "TENANT_ID": "${SHAREPOINT_TENANT_ID}",
      "CLIENT_ID": "${SHAREPOINT_CLIENT_ID}",
      "CLIENT_SECRET": "${SHAREPOINT_CLIENT_SECRET}"
    }
  }
}
</code></pre>
<h3>Environment Variables</h3>
<pre><code class="language-bash">SHAREPOINT_URL=https://abctest179.sharepoint.com/sites/Permission-Scanner-Test
SHAREPOINT_TENANT_ID=your-tenant-id
SHAREPOINT_CLIENT_ID=your-app-client-id
SHAREPOINT_CLIENT_SECRET=your-client-secret
</code></pre>
<hr>
<h2>Azure AD App Setup</h2>
<h3>Required Permissions</h3>
<table>
<thead><tr><th>API</th><th>Permission</th><th>Type</th></tr></thead>
<tbody><tr><td>Microsoft Graph</td><td>Sites.Read.All</td><td>Application</td></tr>
<tr><td>Microsoft Graph</td><td>Files.Read.All</td><td>Application</td></tr>
<tr><td>SharePoint</td><td>Sites.Read.All</td><td>Application</td></tr>
</tbody></table>
<h3>Steps</h3>
1. Create app registration in Azure Portal
2. Add API permissions (above)
3. Grant admin consent
4. Create client secret
5. Copy Client ID, Tenant ID, and Secret
</p>
<hr>
<h2>Available Tools</h2>
<h3>search_files</h3>
Search for files across SharePoint.
</p>
<p>
<strong>Parameters:</strong>
<ul><li><code>query</code> (required): Search query string</li>
<li><code>limit</code> (optional): Max results (default: 10)</li>
</ul>
<strong>Example:</strong>
<pre><code class="language-text">Search for "permissions report" in SharePoint
</code></pre>
<h3>list_sites</h3>
List accessible SharePoint sites.
</p>
<p>
<strong>Parameters:</strong>
<ul><li><code>search</code> (optional): Filter sites by name</li>
</ul>
<strong>Example:</strong>
<pre><code class="language-text">List all SharePoint sites
</code></pre>
<h3>get_site_info</h3>
Get detailed information about a site.
</p>
<p>
<strong>Parameters:</strong>
<ul><li><code>siteUrl</code> (required): Full site URL</li>
</ul>
<strong>Example:</strong>
<pre><code class="language-text">Get info for https://abctest179.sharepoint.com/sites/Permission-Scanner-Test
</code></pre>
<h3>list_site_drives</h3>
List document libraries in a site.
</p>
<p>
<strong>Parameters:</strong>
<ul><li><code>siteUrl</code> (required): Site URL</li>
</ul>
<strong>Example:</strong>
<pre><code class="language-text">List document libraries in the Permission Scanner Test site
</code></pre>
<h3>list_drive_items</h3>
Browse folder contents.
</p>
<p>
<strong>Parameters:</strong>
<ul><li><code>siteUrl</code> (required): Site URL</li>
<li><code>driveId</code> (optional): Specific drive ID</li>
<li><code>folderPath</code> (optional): Folder path (default: root)</li>
</ul>
<strong>Example:</strong>
<pre><code class="language-text">List files in TestLibrary_Basic folder
</code></pre>
<h3>get_file_content</h3>
Read text file contents.
</p>
<p>
<strong>Parameters:</strong>
<ul><li><code>siteUrl</code> (required): Site URL</li>
<li><code>filePath</code> (required): Path to file</li>
<li><code>driveId</code> (optional): Drive ID</li>
</ul>
<strong>Example:</strong>
<pre><code class="language-text">Read the contents of report.txt from Documents
</code></pre>
<hr>
<h2>Usage Examples</h2>
<h3>In Claude Code</h3>
<pre><code class="language-text">User: List the folders in TestLibrary_Basic
</p>
<p>
Claude: [Uses list_drive_items tool]
Here are the folders in TestLibrary_Basic:
<ul><li>Folder1</li>
<li>Folder2</li>
<li>Department1</li>
<li>Department2</li>
</ul>...
</code></pre>
<pre><code class="language-text">User: Search for permission reports
</p>
<p>
Claude: [Uses search_files tool]
Found 3 matching files:
1. PermissionReport_2026.xlsx
2. Permissions_Audit.docx
...
</code></pre>
<hr>
<h2>Troubleshooting</h2>
<table>
<thead><tr><th>Issue</th><th>Solution</th></tr></thead>
<tbody><tr><td>"Unauthorized"</td><td>Check client secret is valid</td></tr>
<tr><td>"Site not found"</td><td>Verify SHAREPOINT_URL is correct</td></tr>
<tr><td>"Permission denied"</td><td>Grant admin consent for API permissions</td></tr>
<tr><td>"Token expired"</td><td>Restart MCP server</td></tr>
</tbody></table>
<h3>Test Authentication</h3>
<pre><code class="language-bash"># Get token manually
curl -X POST "https://login.microsoftonline.com/$TENANT_ID/oauth2/v2.0/token" \
  -d "client_id=$CLIENT_ID" \
  -d "client_secret=$CLIENT_SECRET" \
  -d "scope=https://graph.microsoft.com/.default" \
  -d "grant_type=client_credentials"
</code></pre>
<hr>
<h2>Project Configuration</h2>
<pre><code class="language-text">Site URL:    https://abctest179.sharepoint.com/sites/Permission-Scanner-Test
Library:     TestLibrary_Basic
Tenant:      ABCTest179
</code></pre>
<hr>
<p>
<em>Last Updated: 2026-01-09</em>

</p>
            </main>
        </div>

        <footer>
            <p>Generated from Markdown documentation | Power Platform Setup Guide</p>
        </footer>
    </div>
</body>
</html>