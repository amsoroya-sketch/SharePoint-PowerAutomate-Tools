<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dataverse MCP - Power Platform Documentation</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Power Platform Setup Documentation</h1>
            <p class="subtitle">SharePoint Permission Scanner Project</p>
        </header>

        <div class="main-content">
            <nav class="sidebar">
                <div class="nav-section">
<h3>Getting Started</h3>
<ul>
<li><a href="README.html">Overview</a></li>
<li><a href="CLI-TOOLS-SETUP.html">CLI Tools Setup</a></li>
</ul>
</div>
<div class="nav-section">
<h3>CLI Tools</h3>
<ul>
<li><a href="cli-tools-install-all-ps1.html">Installation Script</a></li>
<li><a href="cli-tools-pac-cli.html">PAC CLI</a></li>
<li><a href="cli-tools-m365-cli.html">m365 CLI</a></li>
<li><a href="cli-tools-az-cli.html">Azure CLI</a></li>
<li><a href="cli-tools-func-cli.html">Functions CLI</a></li>
<li><a href="cli-tools-pnp-powershell.html">PnP PowerShell</a></li>
</ul>
</div>
<div class="nav-section">
<h3>Power Platform</h3>
<ul>
<li><a href="01-power-automate-setup-guide.html">Power Automate</a></li>
<li><a href="01-power-automate-troubleshooting.html">Troubleshooting</a></li>
<li><a href="01-power-automate-cli-reference.html">CLI Reference</a></li>
<li><a href="02-power-apps-setup-guide.html">Power Apps</a></li>
<li><a href="03-dataverse-setup-guide.html">Dataverse</a></li>
<li><a href="03-dataverse-cli-reference.html">Dataverse CLI</a></li>
</ul>
</div>
<div class="nav-section">
<h3>Microsoft 365</h3>
<ul>
<li><a href="04-sharepoint-setup-guide.html">SharePoint</a></li>
<li><a href="04-sharepoint-cli-reference.html">SharePoint CLI</a></li>
<li><a href="08-teams-setup-guide.html">Microsoft Teams</a></li>
<li><a href="11-microsoft-graph-setup-guide.html">Microsoft Graph</a></li>
</ul>
</div>
<div class="nav-section">
<h3>Azure</h3>
<ul>
<li><a href="05-azure-portal-app-registration.html">App Registration</a></li>
<li><a href="09-azure-functions-setup-guide.html">Azure Functions</a></li>
<li><a href="10-azure-keyvault-setup-guide.html">Key Vault</a></li>
<li><a href="07-azure-devops-setup-guide.html">Azure DevOps</a></li>
<li><a href="06-power-bi-setup-guide.html">Power BI</a></li>
</ul>
</div>
<div class="nav-section">
<h3>MCP Servers</h3>
<ul>
<li><a href="mcp-servers-README.html">Overview</a></li>
<li><a href="mcp-servers-sharepoint-mcp.html">SharePoint MCP</a></li>
<li><a href="mcp-servers-azure-devops-mcp.html">DevOps MCP</a></li>
<li><a href="mcp-servers-dataverse-mcp.html" class="active">Dataverse MCP</a></li>
</ul>
</div>
<div class="nav-section">
<h3>Skills</h3>
<ul>
<li><a href="skills-README.html">Skills Overview</a></li>
<li><a href="skills-skill-usage-guide.html">Usage Guide</a></li>
<li><a href="skills-knowledge-base-index.html">Knowledge Base</a></li>
</ul>
</div>

            </nav>

            <main class="content">
                <div class="source-info">
                    <span>Source: mcp-servers/dataverse-mcp.md</span>
                    <span>Generated: 2026-01-09 19:55</span>
                </div>
                <h1>Dataverse MCP Server</h1>
<p>
Options for real-time Dataverse access via Model Context Protocol.
</p>
<hr>
<h2>Overview</h2>
<p>
Dataverse access can be achieved through:
1. <strong>Microsoft Graph API</strong> (via graph-mcp or http requests)
2. <strong>Dataverse Web API</strong> (custom MCP server)
3. <strong>SQL endpoint</strong> (via mssql-mcp)
</p>
<hr>
<h2>Option 1: Dataverse SQL Endpoint</h2>
<p>
Use the MSSQL MCP server to query Dataverse via its SQL endpoint.
</p>
<h3>Configuration</h3>
<pre><code class="language-json">{
  "mssql": {
    "command": "npx",
    "args": ["-y", "@knight0zh/mssql-mcp-server"],
    "env": {
      "MSSQL_HOST": "${DATAVERSE_SQL_HOST}",
      "MSSQL_DATABASE": "${DATAVERSE_DATABASE}"
    }
  }
}
</code></pre>
<h3>Environment Variables</h3>
<pre><code class="language-bash">DATAVERSE_SQL_HOST=org.crm.dynamics.com
DATAVERSE_DATABASE=OrgName
</code></pre>
<h3>Enable SQL Endpoint</h3>
1. Go to <strong>Power Platform Admin Center</strong>
2. Select environment
3. Click <strong>Settings</strong> > <strong>Features</strong>
4. Enable <strong>TDS endpoint</strong>
</p>
<h3>Query Examples</h3>
<pre><code class="language-sql">-- List scan sessions
SELECT sp_name, sp_status, sp_totalfolders
FROM sp_scansession
WHERE sp_status = 'Completed'
ORDER BY createdon DESC
</p>
<p>
-- Count folders with unique permissions
SELECT COUNT(*)
FROM sp_folderrecord
WHERE sp_hasuniquepermissions = 1
</code></pre>
<hr>
<h2>Option 2: Custom Dataverse MCP Server</h2>
<p>
Create a custom MCP server using the Dataverse Web API.
</p>
<h3>Server Structure</h3>
<pre><code class="language-text">dataverse-mcp/
├── package.json
├── src/
│   ├── index.ts
│   ├── auth.ts
│   └── tools/
│       ├── listRecords.ts
│       ├── getRecord.ts
│       └── createRecord.ts
└── README.md
</code></pre>
<h3>Package.json</h3>
<pre><code class="language-json">{
  "name": "dataverse-mcp-server",
  "version": "1.0.0",
  "type": "module",
  "main": "dist/index.js",
  "scripts": {
    "build": "tsc",
    "start": "node dist/index.js"
  },
  "dependencies": {
    "@modelcontextprotocol/sdk": "^0.5.0",
    "@azure/identity": "^4.0.0"
  }
}
</code></pre>
<h3>Basic Implementation</h3>
<pre><code class="language-typescript">// src/index.ts
import { Server } from "@modelcontextprotocol/sdk/server/index.js";
import { StdioServerTransport } from "@modelcontextprotocol/sdk/server/stdio.js";
</p>
<p>
const server = new Server({
  name: "dataverse-mcp",
  version: "1.0.0"
}, {
  capabilities: {
    tools: {}
  }
});
</p>
<p>
// Register tools
server.setRequestHandler("tools/list", async () =&gt; ({
  tools: [
    {
      name: "list_records",
      description: "List records from a Dataverse table",
      inputSchema: {
        type: "object",
        properties: {
          table: { type: "string", description: "Table logical name" },
          filter: { type: "string", description: "OData filter" },
          top: { type: "number", description: "Max records" }
        },
        required: ["table"]
      }
    }
  ]
}));
</p>
<p>
server.setRequestHandler("tools/call", async (request) =&gt; {
  const { name, arguments: args } = request.params;
</p>
<p>
  if (name === "list_records") {
    const records = await queryDataverse(args.table, args.filter, args.top);
    return { content: [{ type: "text", text: JSON.stringify(records) }] };
  }
});
</p>
<p>
async function queryDataverse(table: string, filter?: string, top?: number) {
  const token = await getAccessToken();
  const url = <code>${process.env.DATAVERSE_URL}/api/data/v9.2/${table}</code>;
</p>
<p>
  const response = await fetch(url, {
    headers: { Authorization: <code>Bearer ${token}</code> }
  });
</p>
<p>
  return response.json();
}
</p>
<p>
const transport = new StdioServerTransport();
await server.connect(transport);
</code></pre>
<hr>
<h2>Option 3: HTTP Requests via Azure MCP</h2>
<p>
Use the Azure MCP server with Dataverse Web API.
</p>
<h3>Configuration</h3>
<pre><code class="language-json">{
  "azure": {
    "command": "npx",
    "args": ["-y", "@azure/mcp@latest", "server", "start"],
    "env": {
      "AZURE_SUBSCRIPTION_ID": "${AZURE_SUBSCRIPTION_ID}"
    }
  }
}
</code></pre>
<h3>Dataverse API Endpoints</h3>
<pre><code class="language-text">Base URL: https://[org].crm.dynamics.com/api/data/v9.2/
</p>
<p>
Tables:
<ul><li>sp_scansessions</li>
<li>sp_folderrecords</li>
<li>sp_permissionentries</li>
</ul></code></pre>
<hr>
<h2>Dataverse Web API Reference</h2>
<h3>Authentication</h3>
<pre><code class="language-bash"># Get token
TOKEN=$(az account get-access-token --resource https://[org].crm.dynamics.com --query accessToken -o tsv)
</code></pre>
<h3>List Records</h3>
<pre><code class="language-bash">curl -X GET "https://[org].crm.dynamics.com/api/data/v9.2/sp_scansessions" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Accept: application/json"
</code></pre>
<h3>Filter Records</h3>
<pre><code class="language-bash">curl -X GET "https://[org].crm.dynamics.com/api/data/v9.2/sp_scansessions?\$filter=sp_status eq 'Completed'" \
  -H "Authorization: Bearer $TOKEN"
</code></pre>
<h3>Create Record</h3>
<pre><code class="language-bash">curl -X POST "https://[org].crm.dynamics.com/api/data/v9.2/sp_scansessions" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"sp_name": "Test Scan", "sp_status": "Running"}'
</code></pre>
<hr>
<h2>Project Tables</h2>
<table>
<thead><tr><th>Table</th><th>Logical Name</th></tr></thead>
<tbody><tr><td>Scan Sessions</td><td>sp_scansessions</td></tr>
<tr><td>Folder Records</td><td>sp_folderrecords</td></tr>
<tr><td>Permission Entries</td><td>sp_permissionentries</td></tr>
</tbody></table>
<h3>Common Queries</h3>
<pre><code class="language-text"># Recent scans
sp_scansessions?$orderby=createdon desc&amp;$top=10
</p>
<h1>Completed scans with folders</h1>
sp_scansessions?$filter=sp_status eq 'Completed'&amp;$select=sp_name,sp_totalfolders
</p>
<h1>Folders with unique permissions</h1>
sp_folderrecords?$filter=sp_hasuniquepermissions eq true
</code></pre>
<hr>
<h2>Recommended Approach</h2>
<p>
For the SharePoint Permission Scanner project:
</p>
<p>
1. <strong>Development:</strong> Use SQL endpoint via mssql-mcp for quick queries
2. <strong>Production:</strong> Build custom dataverse-mcp-server for full control
3. <strong>Alternative:</strong> Use Power Automate as intermediary
</p>
<hr>
<p>
<em>Last Updated: 2026-01-09</em>

</p>
            </main>
        </div>

        <footer>
            <p>Generated from Markdown documentation | Power Platform Setup Guide</p>
        </footer>
    </div>
</body>
</html>