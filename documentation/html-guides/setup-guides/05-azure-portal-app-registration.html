<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>App Registration - Power Platform Documentation</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Power Platform Setup Documentation</h1>
            <p class="subtitle">SharePoint Permission Scanner Project</p>
        </header>

        <div class="main-content">
            <nav class="sidebar">
                <div class="nav-section">
<h3>Getting Started</h3>
<ul>
<li><a href="README.html">Overview</a></li>
<li><a href="CLI-TOOLS-SETUP.html">CLI Tools Setup</a></li>
</ul>
</div>
<div class="nav-section">
<h3>CLI Tools</h3>
<ul>
<li><a href="cli-tools-install-all-ps1.html">Installation Script</a></li>
<li><a href="cli-tools-pac-cli.html">PAC CLI</a></li>
<li><a href="cli-tools-m365-cli.html">m365 CLI</a></li>
<li><a href="cli-tools-az-cli.html">Azure CLI</a></li>
<li><a href="cli-tools-func-cli.html">Functions CLI</a></li>
<li><a href="cli-tools-pnp-powershell.html">PnP PowerShell</a></li>
</ul>
</div>
<div class="nav-section">
<h3>Power Platform</h3>
<ul>
<li><a href="01-power-automate-setup-guide.html">Power Automate</a></li>
<li><a href="01-power-automate-troubleshooting.html">Troubleshooting</a></li>
<li><a href="01-power-automate-cli-reference.html">CLI Reference</a></li>
<li><a href="02-power-apps-setup-guide.html">Power Apps</a></li>
<li><a href="03-dataverse-setup-guide.html">Dataverse</a></li>
<li><a href="03-dataverse-cli-reference.html">Dataverse CLI</a></li>
</ul>
</div>
<div class="nav-section">
<h3>Microsoft 365</h3>
<ul>
<li><a href="04-sharepoint-setup-guide.html">SharePoint</a></li>
<li><a href="04-sharepoint-cli-reference.html">SharePoint CLI</a></li>
<li><a href="08-teams-setup-guide.html">Microsoft Teams</a></li>
<li><a href="11-microsoft-graph-setup-guide.html">Microsoft Graph</a></li>
</ul>
</div>
<div class="nav-section">
<h3>Azure</h3>
<ul>
<li><a href="05-azure-portal-app-registration.html" class="active">App Registration</a></li>
<li><a href="09-azure-functions-setup-guide.html">Azure Functions</a></li>
<li><a href="10-azure-keyvault-setup-guide.html">Key Vault</a></li>
<li><a href="07-azure-devops-setup-guide.html">Azure DevOps</a></li>
<li><a href="06-power-bi-setup-guide.html">Power BI</a></li>
</ul>
</div>
<div class="nav-section">
<h3>MCP Servers</h3>
<ul>
<li><a href="mcp-servers-README.html">Overview</a></li>
<li><a href="mcp-servers-sharepoint-mcp.html">SharePoint MCP</a></li>
<li><a href="mcp-servers-azure-devops-mcp.html">DevOps MCP</a></li>
<li><a href="mcp-servers-dataverse-mcp.html">Dataverse MCP</a></li>
</ul>
</div>
<div class="nav-section">
<h3>Skills</h3>
<ul>
<li><a href="skills-README.html">Skills Overview</a></li>
<li><a href="skills-skill-usage-guide.html">Usage Guide</a></li>
<li><a href="skills-knowledge-base-index.html">Knowledge Base</a></li>
</ul>
</div>

            </nav>

            <main class="content">
                <div class="source-info">
                    <span>Source: 05-azure-portal/app-registration.md</span>
                    <span>Generated: 2026-01-09 19:55</span>
                </div>
                <h1>Azure Portal - App Registration Guide</h1>
<p>
Complete guide for creating and configuring Azure AD (Entra ID) app registrations.
</p>
<hr>
<h2>Access Azure Portal</h2>
<h3>URL</h3>
<pre><code class="language-text">https://portal.azure.com
</code></pre>
<h3>Navigate to App Registrations</h3>
1. Search for <strong>Microsoft Entra ID</strong> (or Azure Active Directory)
2. Click <strong>App registrations</strong> in left menu
3. Or direct: <code>https://portal.azure.com/#view/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/~/RegisteredApps</code>
</p>
<hr>
<h2>Create App Registration</h2>
<h3>Step 1: Start Registration</h3>
1. Click <strong>+ New registration</strong>
</p>
<h3>Step 2: Configure Basic Settings</h3>
<table>
<thead><tr><th>Field</th><th>Value</th></tr></thead>
<tbody><tr><td>Name</td><td><code>m365-cli</code> (or descriptive name)</td></tr>
<tr><td>Supported account types</td><td>Accounts in this organizational directory only</td></tr>
<tr><td>Redirect URI</td><td>Public client/native > <code>http://localhost</code></td></tr>
</tbody></table>
<h3>Step 3: Register</h3>
1. Click <strong>Register</strong>
2. Copy the <strong>Application (client) ID</strong>
3. Copy the <strong>Directory (tenant) ID</strong>
</p>
<hr>
<h2>Configure API Permissions</h2>
<h3>Navigate to Permissions</h3>
1. Open your app registration
2. Click <strong>API permissions</strong> in left menu
</p>
<h3>Add Microsoft Graph Permissions</h3>
<p>
Click <strong>+ Add a permission</strong> > <strong>Microsoft Graph</strong> > <strong>Delegated permissions</strong>
</p>
<table>
<thead><tr><th>Permission</th><th>Purpose</th></tr></thead>
<tbody><tr><td>User.Read</td><td>Basic user profile</td></tr>
<tr><td>Directory.Read.All</td><td>Read directory data</td></tr>
<tr><td>Sites.Read.All</td><td>Read SharePoint sites</td></tr>
<tr><td>Sites.ReadWrite.All</td><td>Read/write SharePoint</td></tr>
</tbody></table>
<h3>Add Power Automate Permissions</h3>
<p>
Click <strong>+ Add a permission</strong> > <strong>APIs my organization uses</strong> > Search "Power Automate"
</p>
<table>
<thead><tr><th>Permission</th><th>Purpose</th></tr></thead>
<tbody><tr><td>Flows.Read.All</td><td>Read all flows</td></tr>
<tr><td>Flows.Manage.All</td><td>Manage flows</td></tr>
</tbody></table>
<h3>Add SharePoint Permissions</h3>
<p>
Click <strong>+ Add a permission</strong> > <strong>SharePoint</strong> > <strong>Delegated permissions</strong>
</p>
<table>
<thead><tr><th>Permission</th><th>Purpose</th></tr></thead>
<tbody><tr><td>Sites.Read.All</td><td>Read SharePoint sites</td></tr>
<tr><td>AllSites.Read</td><td>Read all sites</td></tr>
<tr><td>AllSites.FullControl</td><td>Full control (optional)</td></tr>
</tbody></table>
<h3>Add Dataverse Permissions (if needed)</h3>
<p>
Click <strong>+ Add a permission</strong> > <strong>APIs my organization uses</strong> > Search "Dataverse" or "Common Data Service"
</p>
<table>
<thead><tr><th>Permission</th><th>Purpose</th></tr></thead>
<tbody><tr><td>user_impersonation</td><td>Access Dataverse as user</td></tr>
</tbody></table>
<h3>Grant Admin Consent</h3>
1. Click <strong>Grant admin consent for [Tenant]</strong>
2. Click <strong>Yes</strong> to confirm
3. Verify status shows ✓ Granted
</p>
<hr>
<h2>Configure Authentication</h2>
<h3>Enable Public Client Flow</h3>
1. Click <strong>Authentication</strong> in left menu
2. Scroll to <strong>Advanced settings</strong>
3. Set <strong>Allow public client flows</strong> to <strong>Yes</strong>
4. Click <strong>Save</strong>
</p>
<h3>Add Redirect URIs (if needed)</h3>
1. Click <strong>Authentication</strong>
2. Under platform configurations, click <strong>Add a platform</strong>
3. Select <strong>Mobile and desktop applications</strong>
4. Add: <code>http://localhost</code>
5. Click <strong>Configure</strong>
</p>
<hr>
<h2>Create Client Secret (for app-only auth)</h2>
<h3>Generate Secret</h3>
1. Click <strong>Certificates & secrets</strong> in left menu
2. Click <strong>+ New client secret</strong>
3. Enter description: <code>m365-cli-secret</code>
4. Select expiration (6 months, 1 year, 2 years)
5. Click <strong>Add</strong>
</p>
<h3>Copy Secret</h3>
<strong>IMPORTANT</strong>: Copy the <strong>Value</strong> immediately - it won't be shown again!
</p>
<pre><code class="language-text">Secret ID:    abc123...
Value:        xxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx ← Copy this!
Expires:      01/08/2027
</code></pre>
<hr>
<h2>Configure Token Settings</h2>
<h3>Optional Claims</h3>
1. Click <strong>Token configuration</strong>
2. Click <strong>+ Add optional claim</strong>
3. Select token type (ID, Access, SAML)
4. Choose claims to include
</p>
<h3>Common Claims</h3>
<table>
<thead><tr><th>Claim</th><th>Purpose</th></tr></thead>
<tbody><tr><td>email</td><td>User email</td></tr>
<tr><td>upn</td><td>User principal name</td></tr>
<tr><td>groups</td><td>Group memberships</td></tr>
</tbody></table>
<hr>
<h2>Expose an API (for custom APIs)</h2>
<h3>Set Application ID URI</h3>
1. Click <strong>Expose an API</strong>
2. Click <strong>Set</strong> next to Application ID URI
3. Accept default or customize: <code>api://[client-id]</code>
4. Click <strong>Save</strong>
</p>
<h3>Add Scope</h3>
1. Click <strong>+ Add a scope</strong>
2. Configure:
   - Scope name: <code>access_as_user</code>
   - Who can consent: Admins and users
   - Admin consent display name: Access API
   - Admin consent description: Allow access to API
3. Click <strong>Add scope</strong>
</p>
<hr>
<h2>App Roles (for enterprise apps)</h2>
<h3>Create Role</h3>
1. Click <strong>App roles</strong>
2. Click <strong>+ Create app role</strong>
3. Configure:
   - Display name: <code>Reader</code>
   - Value: <code>Reader</code>
   - Description: Read-only access
   - Allowed member types: Users/Groups
4. Click <strong>Apply</strong>
</p>
<hr>
<h2>Project Configuration</h2>
<h3>m365 CLI App</h3>
<pre><code class="language-text">Name:           m365-cli
Application ID: [Your App ID]
Tenant ID:      [Your Tenant ID]
Redirect URI:   http://localhost
</p>
<p>
Required Permissions:
├── Microsoft Graph
│   ├── User.Read (Delegated)
│   ├── Directory.Read.All (Delegated)
│   └── Sites.Read.All (Delegated)
├── Power Automate (Flows)
│   └── Flows.Read.All (Delegated)
└── SharePoint
    └── Sites.Read.All (Delegated)
</code></pre>
<h3>Usage</h3>
<pre><code class="language-bash">m365 login --authType deviceCode --appId [Your App ID]
</code></pre>
<hr>
<h2>Common Permission Sets</h2>
<h3>Read-Only Access</h3>
<pre><code class="language-text">Microsoft Graph:
├── User.Read
├── Directory.Read.All
└── Sites.Read.All
</p>
<p>
SharePoint:
└── Sites.Read.All
</p>
<p>
Power Automate:
└── Flows.Read.All
</code></pre>
<h3>Full Management</h3>
<pre><code class="language-text">Microsoft Graph:
├── User.ReadWrite.All
├── Directory.ReadWrite.All
└── Sites.FullControl.All
</p>
<p>
SharePoint:
└── AllSites.FullControl
</p>
<p>
Power Automate:
└── Flows.Manage.All
</code></pre>
<hr>
<h2>Troubleshooting</h2>
<table>
<thead><tr><th>Issue</th><th>Solution</th></tr></thead>
<tbody><tr><td>"Consent required"</td><td>Grant admin consent</td></tr>
<tr><td>"Invalid client"</td><td>Check client ID</td></tr>
<tr><td>"Reply URL mismatch"</td><td>Add redirect URI</td></tr>
<tr><td>"Permission denied"</td><td>Check granted permissions</td></tr>
<tr><td>"Token expired"</td><td>Re-authenticate</td></tr>
</tbody></table>
<h3>Check App Status</h3>
1. Go to <strong>Enterprise applications</strong>
2. Search for your app
3. Check <strong>Properties</strong> and <strong>Permissions</strong>
</p>
<h3>View Audit Logs</h3>
1. Go to <strong>Microsoft Entra ID</strong>
2. Click <strong>Audit logs</strong>
3. Filter by application
</p>
<hr>
<h2>Security Best Practices</h2>
<h3>Secrets</h3>
<ul><li>Use certificates instead of client secrets when possible</li>
<li>Rotate secrets regularly</li>
<li>Never commit secrets to source control</li>
<li>Use Azure Key Vault for storage</li>
</ul>
<h3>Permissions</h3>
<ul><li>Request minimum required permissions</li>
<li>Use delegated permissions when possible</li>
<li>Review permissions regularly</li>
<li>Document permission requirements</li>
</ul>
<h3>Access</h3>
<ul><li>Enable MFA for admin accounts</li>
<li>Use Conditional Access policies</li>
<li>Monitor sign-in logs</li>
<li>Review app usage regularly</li>
</ul>
<hr>
<h2>Related Documentation</h2>
<ul><li><a href="https://learn.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app" target="_blank">App Registration Overview</a></li>
<li><a href="https://learn.microsoft.com/en-us/graph/permissions-reference" target="_blank">Microsoft Graph Permissions</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-auth-code-flow" target="_blank">OAuth 2.0 Flows</a></li>
</ul>
<hr>
<p>
<em>Last Updated: 2026-01-08</em>

</p>
            </main>
        </div>

        <footer>
            <p>Generated from Markdown documentation | Power Platform Setup Guide</p>
        </footer>
    </div>
</body>
</html>